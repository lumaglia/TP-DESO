@startuml


skinparam style strictuml

hide footBox
title Diagrama de Secuencia CU 02 - Buscar Huesped

actor Conserje as Con
boundary "UI - Ocupar Habitacion" as UI
control "Gestor Huesped" as GH
participant "HuespedDAO" as HDAO

Con -> UI: Solicitar buscar huespedes
activate UI

UI->Con: Mostrar campos de criterio de busqueda: Nombre, Apellido, Tipo Doc y Nro Doc
deactivate UI
Con->UI: completa algunos campos o ninguno y presiona ACEPTAR
activate UI
UI->GH: buscarHuespedes(huespedDTO)
deactivate UI
activate GH
alt algun campo de huespedDTO no nulo
  GH->HDAO: buscarHuespedes(huespedDTO)
  activate HDAO
  GH<--HDAO: :listHuespedDTO
  deactivate HDAO
else todos los campos de huespedDTO nulos
  GH->HDAO: getHuespedes()
  activate HDAO
  GH<--HDAO: :listHuespedDTO
  deactivate HDAO
end
opt listHuespedDTO estÃ¡ vacia
  UI<--GH: lanzarExcepcion("No hay coincidencias en el sistema")
  deactivate GH
  activate UI
  Con<--UI: mostrarMensaje("No se han encontrado huespedes para los criterios seleccionados")
  Con<--UI: Ejecutar CU 09 - Dar Alta Huesped
  deactivate UI
  activate GH
end
GH->GH: crearGrilla(listHuespedDTO)
activate GH
deactivate GH
UI<--GH: :objetoGrilla
deactivate GH
activate UI
Con<--UI: mostrarGrillaHuespedes(objetoGrilla)
deactivate UI

opt presiona SIGUIENTE sin seleccionar huesped
  Con->UI: presiona SIGUIENTE
  activate UI
  Con<--UI: Ejecutar CU 09 - Dar Alta Huesped
  deactivate UI
end
Con->UI: Seleccionar huesped 
activate UI
opt existe huesped marcado
  UI->UI: vaciarMarcas()
  activate UI
  deactivate UI
end
UI->UI: marcarHuesped(huespedDTO)
activate UI
deactivate UI
Con<--UI: mostrarCambios()
deactivate UI
Con->UI: presiona SIGUIENTE
activate UI
UI->GH: getHuespedInstance(huespedDTO)
deactivate UI
activate GH


create participant "unaDireccion:Direccion" as D1
GH --> D1: new Direccion
activate D1
GH -> D1: setDomicilio(domicilio)
GH -> D1: setDepto(depto)
GH -> D1: setCodigoPostal(codigoPostal)
GH -> D1: setLocalidad(localidad)
GH -> D1: setProvincia(provincia)
GH -> D1: setPais(pais)
GH -> D1: getInstance()
GH <-- D1: unaDireccion
deactivate D1

create participant "unHuesped:Huesped" as H1
GH --> H1: new Huesped
activate H1
GH -> H1: setNombre(nombre)
GH -> H1: setApellido(apellido)
GH -> H1: setTipoDoc(tipoDoc)
GH -> H1: setNumeroDoc(nroDoc)
GH -> H1: setCuil(cuil)
GH -> H1: setPosicionIva(posicionIva)
GH -> H1: setFechaNac(fechaNac)
GH -> H1: setTelefono(telefono)
GH -> H1: setEmail(email)
GH -> H1: setOcupacion(ocupacion)
GH -> H1: setNacionalidad(nacionalidad)
GH -> H1: setDireccion(unaDireccion1)
GH -> H1: getInstance()
GH <-- H1: unHuesped
deactivate H1


UI<--GH: unHuespedDTO
deactivate GH
activate UI
Con<--UI: Ejecutar CU 10 - Modificar Huesped (unHuesped)
deactivate UI


opt EventCancelar
  Con->UI: Presionar cancelar
  activate UI
  UI-->Con: Vuelve a la pantalla principal
deactivate UI
end

@enduml